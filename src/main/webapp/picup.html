<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<link href="/css/picdown.css" rel="stylesheet" type="text/css" />

   <body class=container>
<header> </header>  
 <div class="HolyGrail-body">   
  <main class=HolyGrail-body>
     
 </main>
     
 <nav class="HolyGrail-nav">
  <input type="file" id="fileInput" multiple/>
       
   
   <select id="select-name">
                    <option value="1">111</option>
                    <option value="2">facede</option>
                    <option value="3">face</option>
                </select>
</nav>
<aside class="HolyGrail-ads">

</aside>
</div>
<footer> <button id="selectButton" class="button">Upload</button>

       
</footer>

    <script src="/js/azure-storage-blob.min.js" charset="utf-8"></script>
    
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script>
    
    const accountName = "cs1f9abf47a9b73x49c3x9c1";
    const sasString = "?sv=2019-02-02&ss=bfqt&srt=sco&sp=rwdlacup&se=2020-07-08T17:12:05Z&st=2019-11-06T09:12:05Z&spr=https&sig=fGDtdhwB%2BvA3ayl443p4OIfM0Vxwj%2BNp%2Fb%2BLudKDfN4%3D";
    const containerName = "modelblob1";
    const containerURL = new azblob.ContainerURL(
        `https://${accountName}.blob.core.windows.net/${containerName}?${sasString}`,
        azblob.StorageURL.newPipeline(new azblob.AnonymousCredential));




    const uploadFiles = async () => {
        try {
        	let options2=$("#select-name option:selected");//获取当前选择项.
        	let dir=options2.text();//获取当前选择项的文本.
            const promises = [];
            for (const file of fileInput.files) {
                const blockBlobURL = azblob.BlockBlobURL.fromContainerURL(containerURL,dir+"/"+ file.name);
                promises.push(azblob.uploadBrowserDataToBlockBlob(azblob.Aborter.none, file, blockBlobURL));
                console.log(blockBlobURL.url); 
            }
            await Promise.all(promises);
            alert("upload is successful")
        } catch (error) {
            
        }
    }

    selectButton.addEventListener("click",uploadFiles);
    //fileInput.addEventListener("change", uploadFiles);

	
/*document.getElementById('list-button').addEventListener('click', () => {
     
	 blobService.listBlobsSegmentedWithPrefix('modelblob1',dir+'/', null, (error, results) => {
        if (error) {
            // Handle list blobs error
        } else {
            results.entries.forEach(blob => {
                console.log(blob.name);
            });
        }
    });
    
});*/




           
    
    

/*document.getElementById('delete-button').addEventListener('click', () => {

    var blobName = YOUR_BLOB_NAME;
    blobService.deleteBlobIfExists('mycontainer', blobName, (error, result) => {
        if (error) {
            // Handle delete blob error
        } else {
            console.log('Blob deleted successfully');
        }
    });
    
});*/
 </script>
</html>

