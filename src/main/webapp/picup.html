<!DOCTYPE html>
<html>
    <body>
        <button id="create-button" hidden=hidden>Create Container</button>

        <input type="file" id="fileinput" multiple/>
        <button id="upload-button">Upload</button>

        <button id="list-button">List</button>
        
        <button id="delete-button" hidden=hidden>Delete</button>
    </body>
    <script src="/js/azure-storage.blob.min.js" charset="utf-8"></script>
    <script>
        // Blob-related code goes here
        const account = {
    name: "cs1f9abf47a9b73x49c3x9c1",
    sas: "?sv=2019-02-02&ss=bfqt&srt=sco&sp=rwdlacup&se=2019-10-25T12:52:43Z&st=2019-10-25T04:52:43Z&spr=https&sig=%2BJHuBRpuwdfUxg5TFaL9oD7y3ggYk7U8NZMosT9xeoA%3D"
};

const blobUri = 'https://' + account.name + '.blob.core.windows.net';
const blobService = AzureStorage.Blob.createBlobServiceWithSas(blobUri, account.sas);
/*document.getElementById('create-button').addEventListener('click', () => {

    blobService.createContainerIfNotExists('mycontainer',  (error, container) => {
        if (error) {
            // Handle create container error
        } else {
            console.log(container.name);
        }
    });

});*/
document.getElementById('upload-button').addEventListener('click', () => {
    var len=document.getElementById('fileinput').files.length;
	for(i=0;i<len;i++){
    var file = document.getElementById('fileinput').files[i];

    blobService.createBlockBlobFromBrowserFile('mycontainer', 
                                                file.name, 
                                                file, 
                                                (error, result) => {
                                                    if(error) {
                                                        // Handle blob error
                                                    } else {
                                                        console.log('Upload is successful');
                                                    }
                                                });

	}});
document.getElementById('list-button').addEventListener('click', () => {

    blobService.listBlobsSegmented('mycontainer', null, (error, results) => {
        if (error) {
            // Handle list blobs error
        } else {
            results.entries.forEach(blob => {
                console.log(blob.name);
            });
        }
    });
    
});
/*document.getElementById('delete-button').addEventListener('click', () => {

    var blobName = YOUR_BLOB_NAME;
    blobService.deleteBlobIfExists('mycontainer', blobName, (error, result) => {
        if (error) {
            // Handle delete blob error
        } else {
            console.log('Blob deleted successfully');
        }
    });
    
});*/
    </script>
</html>

